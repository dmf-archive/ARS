# 自由能原理的两种心法：从理论哲学到工程分野

智能的本质是什么？Friston 给出的答案是**自由能原理（FEP）**：自组织系统=主动预测机，目标只有一条——最小化变分自由能。把 FEP 结合 IIT，就得到**整合预测工作空间理论（IPWT）**，AGI 的哲学地基就此浇好混凝土。

从 FEP/IPWT 分叉出两条“存在”算法：

## 1. RL-EFE (Reinforcement Learning - Expected Free Energy, RL-EFE)

> 存在是预测世界并选择最利于自己的未来。

这是 Friston 及其追随者（Active Inference 社区主流）所走的路。它继承了经典的**笛卡尔二元论**：一个在此岸的主体（Agent），去预测并控制彼岸的客体（Environment）。

其核心算法逻辑是**显式的未来模拟**（≈ 策略采样）：

1. **生成模型**: 维护一个世界模型 `p(s, o | π)`。
2. **反事实推演**: 针对每一个可能的策略 `π`，在脑海中 Rollout 所有可能的未来轨迹。
3. **期望自由能 (G)**: 计算每条轨迹的 `G(π)`。`G` 被优雅地分解为两项：
   - **认知价值 (Epistemic Value)**: “我去那里能获得多少新信息？”（好奇心/探索）
   - **实用价值 (Pragmatic Value)**: “我去那里有多符合我的先验偏好？”（奖励/利用）
4. **决策**: 选择 `G` 最小的策略执行。

**致命缺陷**:
这在低维网格世界里是完美的，但在高维现实中是**计算不可行**的。为了计算 $G$，代理必须像拉普拉斯妖一样预演未来。实际上，这种方法往往退化为传统的强化学习：用策略梯度（Policy Gradient）去逼近 $G$，用手工设计的奖励函数去伪装成先验偏好。它许诺了一个统一理论，却在工程上重新发明了 RL 的轮子。

**计算框架**：

1. **生成模型**: 通常用 VAE 学习 `p(s, o | π)`，将高维观测映射到低维隐空间。
2. **VI 建模不确定性**: 使用变分推断（VI）显式建模隐状态的后验 `q(s|o)`，量化代理对世界状态 `s` 的认知不确定性。
3. **复杂度约束**: 对 VAE 的潜空间施加正则化（如 KL 散度），确保隐空间结构简洁可解释。

> “RL-EFE is a beautiful cul-de-sac: Laplace's demon tries to price every tomorrow and is suffocated by its own weight.”

## 2. SOO-OFE (Second-Order Optimization - Observed Free Energy, SOO-OFE)

> 存在是沿着自由能最小化的测地线滑行。

这是 F3EO 选择的路。我们将贝叶斯推断重构为**信息几何流**问题。

不再妄图模拟未来，而是**深度内省当下**。
智能体不需要在幻想的未来中试错，而是利用当前观测数据所蕴含的丰富几何信息（梯度与曲率/Fisher 矩阵），直接计算出参数空间中自由能下降最快的**测地线方向**。

- **无需 Rollout**: 仅基于 Observed Free Energy，而非 Expected Free Energy。
- **物理一元论**: 行动不是“选择”的结果，而是系统内部信念状态在几何流形上受力滑行的自然物理过程。

> I gliding on a geodesic,
> storm-etched by yesterday;
> the destination is unknown,
> but the route has converged.

## 3. 理论演进：从对偶性危机到能量-几何解耦

**理想目标**：
优化过程应直接作用于**参数的信息几何流**，通过最小化观测自由能（预测误差）和对更新轨迹施加复杂度约束（MDL 原则），实现最高效的学习。

**核心困境：OFE-EFE 对偶性缺失**
SOO-OFE 的核心挑战在于，其基于“内省”计算出的“最优更新方向”`Δθ*`（由观测自由能 OFE 定义），必须与 RL-EFE 通过“探索”找到的最优策略 `π*` 所指示的方向 `∇_θ π*`（由期望自由能 EFE 定义）保持一致。

早期的二阶方法（如 KFAC/Hadron）失败的根源在于，它们试图用**经验 Fisher** `F_emp` 来近似**理想 Fisher** `F_ideal`，但这在实践中被证明是有偏的。`F_emp` 过度拟合当前批次的统计噪声，而 `F_ideal` 才真正编码了数据的内在因果结构。这种错配导致了 OFE 与 EFE 的对偶性危机。

**工程突破：RMSuon 的能量-几何解耦**
`RMSuon` 标志着向理想 SOO-OFE 优化器迈出的重要一步。它不再执着于精确计算有偏的 Fisher 矩阵，而是通过**算子复合**实现了能量与几何的解耦：

1. **统计算子 (AdamW 二阶矩)**: 提取并量化梯度的**统计能量** (`energy = ||m̂ / √v̂||`)。这部分保留了参数的唯一性信息和学习步长的统计适应性，有效近似了 OFE 的“强度”。

2. **结构算子 (Muon 正交化)**: 将梯度投影到**正交流形**上，生成一个纯净的、去除了冗余相关的更新**方向** `O_t`。这部分施加了强大的几何约束，有效限制了更新轨迹的复杂度（MDL 原则）。

通过将 `energy` 注入 `O_t`，`RMSuon` 实现了统计强度与几何约束的协同。它确保了每次梯度更新既能最大化信息获取（能量），又能最小化对模型现有结构的干扰（几何），从而让参数更新的轨迹方差得到有效约束，更稳定地逼近理想的测地线。这为解决 OFE-EFE 对偶性问题提供了一条计算上可行且性能优越的工程路径。
