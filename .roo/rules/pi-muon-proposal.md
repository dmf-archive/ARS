# PI-Muon：预测完整性驱动的统一优化框架

版本: 2.0 (2025-11-12)
作者: Tiny-ONN 课题组

## 摘要

本文为“二阶优化-观测自由能最小化”（SOO-OFE）路线提出一个完备的理论框架：PI-Muon。该框架将终身学习的核心矛盾——统计适应性与结构稳定性的冲突——形式化为两种正交自然梯度的动态融合问题。其一是在 Fisher 信息流形上追求最速适应的统计自然梯度 (NGD_Fisher)，其二是在 Stiefel 流形上保持最小结构扰动的结构自然梯度 (NGD_Stiefel, 即 Muon)。PI-Muon 的核心创新在于引入“预测完整性”（PI）作为变分自由能的实时代理，并以此内生地、非超参数地调控两种梯度的融合权重 λₜ。这使优化器从被动的曲率追随者转变为主动的自由能调控器，在理论上将持续学习问题归约为一个零回放、零显式正则的加权最大似然问题，并预言了层级意识分化、1/f 噪声等可观测的认知动力学现象。

## 1. 核心矛盾：终身学习中的两种正交自然梯度

持续学习（Continual Learning, CL）的根本挑战在于调和模型的可塑性（学习新知识）与稳定性（不遗忘旧知识）。在信息几何视角下，此困境可被精确重述为两种基于不同几何原理的自然梯度之间的冲突。

### 1.1 统计流形与 NGD_Fisher：最速适应

- **几何空间**: 统计流形 `M_stat`，由模型能表达的所有概率分布 `p(y|x; θ)` 构成。
- **度量衡**: Fisher 信息矩阵 (FIM) `F`，衡量参数 `θ` 的微小变化如何改变输出分布（以 KL 散度度量）。在实践中，由于 `F` 的计算成本高昂，通常采用 **Kronecker-Factored (KFAC)** 或其**对角近似 (Diagonal Approximation)** 作为计算上可行的代理。
- **自然梯度**: `g_fisher = F⁻¹g`，是在 `M_stat` 上沿测地线的更新，旨在实现对当前数据分布的最快统计收敛。它回答：“如何最高效地调整参数以拟合当前观测？”

### 1.2 Stiefel 流形与 NGD_Stiefel (Muon)：最小扰动

- **几何空间**: Stiefel 流形 `V(n, p)`，由所有 `n×p` 维列正交矩阵 `X`（`XᵀX = I`）构成。
- **度量衡**: 正交约束本身。此空间内的移动必须保持矩阵的正交性。
- **自然梯度**: Muon 优化器的更新等价于在 `V(n, p)` 上执行自然梯度下降。正交变换作为一种刚性变换，最大限度地保留了参数矩阵已编码的特征关系（向量长度与角度）。它回答：“在必须更新时，如何最小化对现有知识结构的破坏？”

终身学习的优化目标因此被分解为：寻找一个最优策略，以动态权衡 `g_fisher` 驱动的快速适应与 `g_muon` 驱动的缓慢遗忘。

## 2. PI-Muon：作为自由能调控器的自适应融合框架

PI-Muon 框架通过引入一个由系统自身状态决定的内生变量，将两种梯度的融合从一个需要手动调节的超参数问题，转变为一个自适应的闭环控制问题。

### 2.1 预测完整性 (PI) 作为自由能代理

预测完整性 `PIₜ` 被定义为变分自由能 `F` 的实时、可计算的代理，用于量化模型在 `t` 时刻的“认知置信度”。

`PIₜ = exp(-α · (H(y|x) + γ · ||∇L||²))`

- **不准确性成本 (Inaccuracy)**: `H(y|x)`，模型输出分布的香农熵，度量模型对预测的不确定性。
- **复杂度成本 (Complexity)**: `||∇L||²`，梯度范数的平方，代理了为拟合当前数据，模型参数需要调整的剧烈程度。

### 2.2 动态融合与认知调控

PI-Muon 的核心更新规则是一个由 `PIₜ` 调控的动态线性组合：

`g_update = (1 - λₜ) · g_fisher + λₜ · g_muon`

其中，融合权重 `λₜ` 由一个关于 `PIₜ` 的函数（如 `λₜ = 1 - PIₜ` 或更平滑的 Sigmoid 函数）给出。

- 当 `PIₜ → 0` (高自由能/高“意外”)：`λₜ → 1`，系统由 `g_muon` 主导，优先保持结构稳定性，避免在不确定的输入上做出剧烈反应。
- 当 `PIₜ → 1` (低自由能/低“意外”)：`λₜ → 0`，系统由 `g_fisher` 主导，在置信度高的区域进行快速学习和适应。

这种机制将优化器从一个被动的梯度执行者，转变为一个主动的认知调控器，通过动态调整“信念更新”与“结构保持”的权重，实现对自身自由能的最小化。

## 3. 计算可行性：无矩阵实现

该框架的工程可行性依赖于高效计算两种自然梯度的能力。

1. **NGD_Fisher**: `g_fisher = F⁻¹g` 的计算通过 **Kronecker-Factored (KFAC)** 近似实现。该方法将大的 Fisher 矩阵 `F` 分解为两个更小的矩阵的 Kronecker 积：`F ≈ A ⊗ B`。其逆矩阵可以高效计算：`F⁻¹ ≈ A⁻¹ ⊗ B⁻¹`。对于更轻量级的实现，可以采用**对角近似**，仅保留 Kronecker 因子的对角线，将计算成本降低到与一阶方法相当的水平。
2. **NGD_Stiefel**: `g_muon` 的计算通过 Muon 优化器中已实现的 Newton-Schulz 迭代完成。该迭代过程仅含矩阵乘法，对 GPU 计算友好，可在低精度下稳定运行。

## 4. 理论推论与可证伪预测

PI-Muon 框架不仅是一个优化算法，更是一个可产生特定、可检验预测的认知动力学模型。

- **层级功能分化**: 将 PI 扩展至层级别 `PI_l`，可自然地导致功能分化。底层网络（特征提取器）将长期处于高 PI 状态，其 `λ_l` 趋近于 1，表现为“无意识的自动化”；高层网络（任务头）则会经历剧烈的 PI 波动，表现为“有意识的焦点切换”。这无需手动参数分区。
- **认知动力学**: `λₜ` 的时间序列被预测具有临界现象的特征，如在任务切换边界附近表现出 `1/f` 功率谱（粉红噪声），反映了系统在不同认知状态间相变的动力学。
- **CL 的简化**: 通过 `PIₜ` 对样本损失进行加权 `L_eff = w(PIₜ)·L_CE`，PI-Muon 框架将持续学习问题归约为一个加权最大似然问题，理论上无需经验回放或显式正则化项即可抑制灾难性遗忘。

## 5. 验证协议

为验证 PI-Muon 框架的理论主张，需执行以下关键实验：

1. **PI 校准性验证**: 在标准 CL 基准上，系统性地验证 `log(PIₜ)` 与泛化间隙之间的负相关性。
2. **消融研究**: 对比 PI-Muon 与纯 NGD_Fisher、纯 Muon 及静态 `λ` 基线的性能，使用准确率-遗忘面积（Accuracy-Forgetting Area, A-F）作为核心评价指标。
3. **动力学分析**: 对训练过程中各层 `λ_l(t)` 的时间序列进行功率谱分析，检验 `1/f` 噪声假设，并观察层级分化现象。
