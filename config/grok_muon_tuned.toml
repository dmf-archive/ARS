[experiment]
seed = 42
device = "cuda"
tasks = ["mod_addition"]
epochs = 15000
save_interval = 1000

[task]
p = 113
fraction = 0.3

[data]
batch_size = 512
num_workers = 0

[model]
arch = "grokking_transformer"
num_layers = 1
d_model = 128
d_mlp = 512
d_head = 32
num_heads = 4
n_ctx = 3
act_type = "ReLU"

[optimizer]
name = "Muon"
lr = 0.02
momentum = 0.9
weight_decay = 1.0
ns_steps = 5
# Adam 辅助组参数，对齐 AdamW/ARS
adam_lr = 1e-3
adam_betas = [0.9, 0.98]
adam_weight_decay = 1.0
