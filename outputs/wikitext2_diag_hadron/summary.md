# F3EO-Bench Experiment Report

## Configuration Summary
```json
{
  "experiment": {
    "tasks": [
      "wikitext2"
    ],
    "seed": 42,
    "device": "cuda"
  },
  "model": {
    "arch": "nano_gpt",
    "vocabulary_size": 40479,
    "embedding_size": 768,
    "sequence_length": 255,
    "num_heads": 12,
    "num_layers": 4
  },
  "data": {
    "batch_size": 8,
    "num_workers": 0,
    "tokenizer_path": "./data/wikitext2_tokenizer.json"
  },
  "optimizer": {
    "name": "DiagFOG",
    "lr": 0.0001,
    "momentum": 0.9,
    "stat_decay": 0.95,
    "damping": 0.001,
    "kl_clip": 0.001,
    "weight_decay": 0.1,
    "TCov": 10,
    "TInv": 100,
    "muon_momentum": 0.95,
    "adam_lr": 0.0001,
    "adam_weight_decay": 0.1,
    "adam_betas": [
      0.9,
      0.95
    ]
  },
  "train": {
    "epochs": 60,
    "log_every": 10,
    "ckpt_every": 2
  }
}
```

## Training Results
| Epoch | Task | Train Loss | LR | PI | Eff. Gamma | Entropy | Grad Norm | Epoch Time (s) | Peak GPU Mem (MB) | Eval Loss | Eval Perplexity |
|-------|------|------------|----|----|------------|---------|-----------|----------------|-------------------|-----------|-----------------|
| 1 | wikitext2 | 22.9916 | 0.000100 | 0.000 | N/A | 5.551 | 36.9487 | 272.10 | 2669.0 | 9.96 | 21096.26 |
| 2 | wikitext2 | 8.0681 | 0.000100 | 0.000 | N/A | 5.394 | 16.2906 | 283.75 | 2669.0 | 7.08 | 1192.20 |
| 3 | wikitext2 | 6.5609 | 0.000100 | 0.000 | N/A | 5.266 | 11.9330 | 284.33 | 2669.0 | 6.40 | 602.13 |
| 4 | wikitext2 | 6.0564 | 0.000100 | 0.000 | N/A | 5.139 | 9.5985 | 284.45 | 2669.0 | 6.16 | 473.67 |
| 5 | wikitext2 | 5.7862 | 0.000100 | 0.000 | N/A | 4.997 | 8.0418 | 283.43 | 2669.0 | 6.06 | 427.95 |
| 6 | wikitext2 | 5.5847 | 0.000100 | 0.000 | N/A | 4.844 | 7.0951 | 283.54 | 2669.0 | 6.00 | 401.69 |
| 7 | wikitext2 | 5.3918 | 0.000100 | 0.000 | N/A | 4.682 | 6.3168 | 283.29 | 2669.0 | 6.00 | 403.69 |
| 8 | wikitext2 | 5.1985 | 0.000100 | 0.000 | N/A | 4.506 | 5.8473 | 284.28 | 2669.0 | 6.01 | 409.40 |
| 9 | wikitext2 | 4.9865 | 0.000100 | 0.000 | N/A | 4.311 | 5.5887 | 284.28 | 2669.0 | 6.08 | 438.70 |
| 10 | wikitext2 | 4.7554 | 0.000100 | 0.000 | N/A | 4.096 | 5.3407 | 286.71 | 2669.0 | 6.21 | 495.45 |
| 11 | wikitext2 | 4.5018 | 0.000100 | 0.000 | N/A | 3.861 | 5.2217 | 285.29 | 2669.0 | 6.36 | 576.45 |
| 12 | wikitext2 | 4.2289 | 0.000100 | 0.000 | N/A | 3.610 | 5.2103 | 286.51 | 2669.0 | 6.50 | 668.21 |
| 13 | wikitext2 | 3.9419 | 0.000100 | 0.000 | N/A | 3.348 | 5.2859 | 286.30 | 2669.0 | 6.94 | 1031.77 |
| 14 | wikitext2 | 3.6446 | 0.000100 | 0.000 | N/A | 3.078 | 5.4500 | 286.00 | 2669.0 | 7.23 | 1382.02 |
| 15 | wikitext2 | 3.3411 | 0.000100 | 0.000 | N/A | 2.811 | 5.6582 | 286.31 | 2669.0 | 7.72 | 2253.69 |
| 16 | wikitext2 | 3.0420 | 0.000100 | 0.000 | N/A | 2.548 | 5.9178 | 286.65 | 2669.0 | 8.07 | 3189.52 |
| 17 | wikitext2 | 2.7497 | 0.000100 | 0.000 | N/A | 2.295 | 6.1943 | 285.93 | 2669.0 | 8.67 | 5827.90 |
| 18 | wikitext2 | 2.4727 | 0.000100 | 0.000 | N/A | 2.056 | 6.4804 | 287.43 | 2669.0 | 9.28 | 10744.02 |
| 19 | wikitext2 | 2.2137 | 0.000100 | 0.000 | N/A | 1.834 | 6.8037 | 285.45 | 2669.0 | 10.12 | 24851.90 |
| 20 | wikitext2 | 1.9741 | 0.000100 | 0.000 | N/A | 1.629 | 7.0748 | 285.24 | 2669.0 | 10.66 | 42746.45 |
| 21 | wikitext2 | 1.7534 | 0.000100 | 0.000 | N/A | 1.440 | 7.3672 | 270.94 | 2668.5 | 11.11 | 66890.57 |
| 22 | wikitext2 | 1.5545 | 0.000100 | 0.000 | N/A | 1.271 | 7.6158 | 287.14 | 2668.5 | 12.05 | 171082.56 |
| 23 | wikitext2 | 1.3752 | 0.000100 | 0.000 | N/A | 1.118 | 7.8498 | 287.54 | 2668.5 | 12.31 | 222917.22 |
| 24 | wikitext2 | 1.2131 | 0.000100 | 0.000 | N/A | 0.980 | 8.0523 | 292.62 | 2668.5 | 13.10 | 489524.87 |
| 25 | wikitext2 | 1.0717 | 0.000100 | 0.000 | N/A | 0.861 | 8.2258 | 292.52 | 2668.5 | 13.64 | 842587.56 |
| 26 | wikitext2 | 0.9478 | 0.000100 | 0.000 | N/A | 0.755 | 8.3842 | 289.22 | 2668.5 | 14.32 | 1650360.10 |
| 27 | wikitext2 | 0.8403 | 0.000100 | 0.000 | N/A | 0.665 | 8.4940 | 291.91 | 2668.5 | 14.83 | 2754084.05 |
| 28 | wikitext2 | 0.7505 | 0.000100 | 0.000 | N/A | 0.588 | 8.6066 | 291.04 | 2668.5 | 15.59 | 5909465.81 |
| 29 | wikitext2 | 0.6712 | 0.000100 | 0.000 | N/A | 0.522 | 8.6514 | 291.21 | 2668.5 | 15.80 | 7309761.58 |
| 30 | wikitext2 | 0.6080 | 0.000100 | 0.000 | N/A | 0.469 | 8.6882 | 289.19 | 2668.5 | 16.10 | 9841063.09 |
| 31 | wikitext2 | 0.5560 | 0.000100 | 0.000 | N/A | 0.426 | 8.6811 | 290.66 | 2668.5 | 16.52 | 14928253.14 |
| 32 | wikitext2 | 0.5142 | 0.000100 | 0.000 | N/A | 0.391 | 8.6505 | 327.15 | 2668.5 | 16.91 | 22161966.98 |
| 33 | wikitext2 | 0.4804 | 0.000100 | 0.000 | N/A | 0.363 | 8.5937 | 344.74 | 2668.5 | 17.04 | 25147110.22 |
| 34 | wikitext2 | 0.4511 | 0.000100 | 0.000 | N/A | 0.339 | 8.4991 | 346.00 | 2668.5 | 17.28 | 32071253.22 |
| 35 | wikitext2 | 0.4290 | 0.000100 | 0.000 | N/A | 0.321 | 8.4004 | 346.80 | 2668.5 | 17.61 | 44621991.52 |
| 36 | wikitext2 | 0.4083 | 0.000100 | 0.000 | N/A | 0.305 | 8.2757 | 344.37 | 2668.5 | 17.49 | 39567345.23 |
| 37 | wikitext2 | 0.3916 | 0.000100 | 0.000 | N/A | 0.292 | 8.1722 | 344.10 | 2668.5 | 17.95 | 62411884.75 |
| 38 | wikitext2 | 0.3766 | 0.000100 | 0.000 | N/A | 0.281 | 8.0588 | 344.02 | 2668.5 | 17.83 | 55141995.00 |
| 39 | wikitext2 | 0.3631 | 0.000100 | 0.000 | N/A | 0.270 | 7.9312 | 344.59 | 2668.5 | 18.01 | 66574891.86 |

## Performance Summary
- **Best Validation Metrics**: wikitext2 Loss: 18.01, wikitext2 Perplexity: 401.69
- **Final Validation Metrics**: wikitext2: {"loss": 18.01383806529798, "perplexity": 66574891.85790196}
